@page "/devices"
@using SSH_Configurer_UI.Model;
@using SSH_Configurer_UI.Components;
@using SSH_Configurer_UI.Services;
@inject NavigationManager navManager;
@inject IDeviceService deviceService;

<DeviceList Devices="devices" DeleteCurrentDevice="DeleteDevice" UpdateCurrentDevice="UpdateDevice"></DeviceList>

@code {
    private List<Device> devices;

    // [Inject]
    // public IDeviceService deviceService { get; set; }

    protected override async Task OnInitializedAsync()
    {
        devices = (await deviceService.GetAllDevices()).ToList();

        await base.OnInitializedAsync();
    }

    private void DeleteDevice(Device device)
    {
        int result = deviceService.RemoveDevice(device).Result;
        if(result==0){
            devices = (deviceService.GetAllDevices()).Result.ToList();
        }    
    }

    private void UpdateDevice(int id)
    {
        navManager.NavigateTo($"./update-device/{id}");
    }
}
